# ER図の作成について
## ユースケースを考える
アプリを誰が使って何をするのか？
詳細を書き出す。

[画面遷移図](https://www.figma.com/file/p157mv2dhHkEW4KPLhG2LM/%E7%94%BB%E9%9D%A2%E9%81%B7%E7%A7%BB%E5%9B%B3?node-id=0%3A1)

### 登場人物
- 投稿者
- 閲覧者

### アプリを使って行うこと
- 投稿者

  - ログイン前
    - Topページを見る(Aboutや使い方)
    - ログインページに飛んでソーシャルログインする
    - 投稿一覧ボタンを押し投稿一覧ページを見る
    - メニューボタンを押す
      - ログイン
      - 投稿一覧     
    - 利用規約、プライバシーポリシーの確認、お問い合わせ

  - ログイン後
    - メニューボタンを押す
      - 犯罪ペットイメージ作成
      - マイペット登録
      - マイページ
      - ログアウト
    - 投稿一覧ページを見る(ログイン後の遷移先ページ)

      - 自分の投稿の場合
        - 削除ボタンを押して投稿を削除する
        - コメントする、見る
          - 自分のコメントを削除、編集する
        - マイペット登録されている場合はペット名を押して自分のペットの犯罪歴(ペットに紐づいた投稿)を見る
          - 削除ボタンを押して投稿を削除する
          - コメントをする、見る
            - 自分のコメントを削除、編集する
          - 自分のペット名を押して、マイページのマイペットタブを見る 
        - 自分のユーザー名を押して自分のマイページを見る

      - 他ユーザーの投稿の場合
        - いいねボタンを押して投稿にいいね、または解除する
        - コメントする、見る
          - 自分のコメントを削除、編集する
        - マイペット登録されている場合はペット名を押して他ユーザーのペットの犯罪歴(ペットに紐づいた投稿)を見る
          - いいねボタンを押して投稿にいいね、または解除する
          - コメントをする、見る
            - 自分のコメントを削除、編集する
          - 対象のペット名を押して、他ユーザ(飼い主)のマイページのマイペットタブを見る   
        - ユーザー名を押して他ユーザーのマイページを見る
          - 投稿一覧タブ
            - いいねボタンを押して投稿にいいね、または解除する
            - コメントする、見る
              - 自分のコメントを削除、編集する
            - マイペット登録されている場合はペット名を押して他ユーザーのペットの犯罪歴(ペットに紐づいた投稿)を見る
          - マイペットタブ
            - 犯罪歴を表示を押して他ユーザーのペットの犯罪歴(ペットに紐づいた投稿)を見る
　　
    - ＋アイコンを押して犯罪ペットイメージ作成
      - テンプレートの選択
      - ペット画像選択
      - トリミングしてはめ込む
  
        - 新しいペットで作成の場合
          - 項目入力(ペットの情報含む)
          - 投稿ボタンを押して投稿
          - マイペット登録画面に遷移  
  
            - マイペット登録する場合
              - はいを押してマイペット登録後Twitter共有画面に遷移
                - Twitterで共有する場合
                  - Twitterで共有ボタンを押して共有
                - Twitterで共有しない場合
                  - 共有しないを押してマイページの投稿一覧画面に遷移
  
            - マイペット登録しない場合
              - いいえを押してTwitter共有画面に遷移
                - Twitterで共有する場合
                  - Twitterで共有ボタンを押して共有
                - Twitterで共有しない場合
                  - 共有しないを押してマイページの投稿一覧画面に遷移
  
        - マイペットから選択の場合
          - マイペットを選択して項目入力(ペット情報の入力はなし)
          - 投稿ボタンを押して投稿
          - Twitter共有画面に遷移
            - Twitterで共有する場合
              - Twitterで共有ボタンを押して共有
            - Twitterで共有しない場合
              - 共有しないを押してマイページの投稿一覧画面に遷移
  
    - ランキングアイコンを押してランキングページを見る

      - 犯罪ペットタブ
        - 自分のペットの場合
          - 自分のユーザー名を押して自分のマイページを見る
          - 犯罪歴を表示を押して自分のペットの犯罪歴(ペットに紐づいた投稿)を見る
        - 他ユーザーのペットの場合
          - ユーザー名を押して他ユーザーのマイページを見る
          - 犯罪歴を表示を押して他ユーザーのペットの犯罪歴(ペットに紐づいた投稿)を見る

      - 犯罪ケースタブ
        - 自分の投稿の場合
          - 削除ボタンを押して投稿を削除する
          - コメントする、見る
          　　- 自分のコメントを削除、編集する
          - マイペット登録されている場合はペット名を押して自分のペットの犯罪歴(ペットに紐づいた投稿)を見る
          - 自分のユーザー名を押して自分のマイページを見る
        - 他ユーザーの投稿の場合
          - いいねボタンを押して投稿にいいね、または解除する
          - コメントする、見る
            - 自分のコメントを削除、編集する
          - マイペット登録されている場合はペット名を押して他ユーザーのペットの犯罪歴(ペットに紐づいた投稿)を見る 
          - ユーザー名を押して他ユーザーのマイページを見る
  　　    
    - マイページアイコンを押してマイページを見る

      - 投稿一覧タブ
        - ユーザー情報を編集を押してユーザー情報編集画面に遷移
          - ユーザー情報を更新する
        - 削除ボタンを押して投稿を削除する
        - Twitterで共有ボタンを押して、Twitter共有する
        - コメントする、見る
        　　- 自分のコメントを削除、編集する

      - マイペットタブ
        - ユーザー情報を編集を押してユーザー情報編集画面に遷移
          - ユーザー情報を更新する
        - マイペット新規登録ボタンを押して、マイペット登録画面に遷移
          - マイペットを新規登録する
        - 編集ボタンを押して、マイペット編集画面に遷移
          - マイペット情報を更新する
        - 削除ボタンを押してマイペットを削除する
        - 犯罪歴を表示を押して自分のペットの犯罪歴(ペットに紐づいた投稿)を見る

      - いいね済タブ
        - ユーザー情報を編集を押してユーザー情報編集画面に遷移
          - ユーザー情報を更新する
        - いいねを解除する
        - コメントする、見る
          - 自分のコメントを削除、編集する
        - マイペット登録されている場合はペット名を押して他ユーザーのペットの犯罪歴(ペットに紐づいた投稿)を見る
        - ユーザー名を押して他ユーザーのマイページを見る
        
    - 利用規約、プライバシーポリシーの確認、お問い合わせ


- 閲覧者

  - ログイン前
    - Topページを見る(Aboutや使い方)
    - ログインページに飛んでソーシャルログインする
    - 投稿一覧ボタンを押し投稿一覧ページを見る
    - メニューボタンを押す
      - ログイン
      - 投稿一覧     
    - 利用規約、プライバシーポリシーの確認、お問い合わせ

  - ログイン後
    - メニューボタンを押す
      - 犯罪ペットイメージ作成
      - マイペット登録
      - マイページ
      - ログアウト
    - 投稿一覧ページを見る(ログイン後の遷移先ページ)
      - 投稿を見る
      - コメントする、見る
        - 自分のコメントを削除、編集する
      - マイペット登録されている場合はペット名を押して他ユーザーのペットの犯罪歴(ペットに紐づいた投稿)を見る
        - いいねボタンを押して投稿にいいね、または解除する
        - コメントする、見る
          - 自分のコメントを削除、編集する
        - 対象のペット名を押して、他ユーザー(飼い主)のマイページのマイペットタブを見る 
      - いいねボタンを押して投稿にいいね、または解除する
      - ユーザー名を押して他ユーザーのマイページを見る
          - 投稿一覧タブ
            - いいねボタンを押して投稿にいいね、または解除する
            - コメントをする、見る
            　　- 自分のコメントを削除、編集する            
            - マイペット登録されている場合はペット名を押して他ユーザーのペットの犯罪歴(ペットに紐づいた投稿)を見る
          - マイペットタブ
            - 犯罪歴を表示を押して他ユーザーのペットの犯罪歴(ペットに紐づいた投稿)を見る

    - ランキングアイコンを押してランキングページを見る

      - 犯罪ペットタブ
        - ユーザー名を押して他ユーザーのマイページを見る
        - 犯罪歴を表示を押して他ユーザーのペットの犯罪歴(ペットに紐づいた投稿)を見る

      - 犯罪ケースタブ
        - いいねボタンを押して投稿にいいね、または解除する
        - コメントをする、見る
          - 自分のコメントを削除、編集する   
        - マイペット登録されている場合はペット名を押して他ユーザーのペットの犯罪歴(ペットに紐づいた投稿)を見る 
        - ユーザー名を押して他ユーザーのマイページを見る
  　　    
    - マイページアイコンを押してマイページを見る

      - 投稿一覧タブ
        - ユーザー情報を編集を押してユーザー情報編集画面に遷移
          - ユーザー情報を更新する

      - マイペットタブ
        - ユーザー情報を編集を押してユーザー情報編集画面に遷移
          - ユーザー情報を更新する

      - いいね済タブ
        - ユーザー情報を編集を押してユーザー情報編集画面に遷移
          - ユーザー情報を更新する
        - いいねを解除する
        - コメントをする、見る
          - 自分のコメントを削除、編集する
        - マイペット登録されている場合はペット名を押して他ユーザーのペットの犯罪歴(ペットに紐づいた投稿)を見る
        - ユーザー名を押して他ユーザーのマイページを見る
        
    - 利用規約、プライバシーポリシーの確認、お問い合わせ

## テーブルを洗い出す
ユースケースを参考にテーブルを洗い出す

- users
- pets
- posts
- comments
- likes
- templates

## リレーションシップを書く
- ユーザーは複数のペットを持ち、ペットはユーザーに属する
- ユーザーは複数の投稿を持ち、投稿はユーザーに属する
- ペットは複数の投稿を持ち、投稿はペットに属する
- ユーザーは複数のコメントを持ち、コメントはユーザーに属する
- 投稿は複数のコメントを持ち、コメントは投稿に属する
- ユーザーは複数のいいねを持ち、いいねはユーザーに属する
- 投稿は複数のいいねを持ち、いいねは投稿に属する

## テーブルのカラムを書く(アトリビュート、属性)
- users 
  - provider(ソーシャルログイン用)
  - uid(ソーシャルログイン用)
  - user_name

- pets
  - user_id
  - image
  - pet_name
  - type
  - sex
  - age

- posts
  - user_id
  - pet_id(登録ペットとの紐付け)
  - image(最終的に出来上がった画像を格納)

- comments
  - user_id
  - post_id
  - body

- likes
  - user_id
  - post_id
